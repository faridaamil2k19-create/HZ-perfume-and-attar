<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Checkout — HZ Perfume and Attar</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
  <style>
    :root{
      --glass-bg: rgba(255,255,255,0.14);
      --glass-border: rgba(255,255,255,0.25);
      --accent: rgba(130,95,255,0.95);
      --accent-2: rgba(88,210,255,0.9);
      --muted: rgba(255,255,255,0.8);
      --glass-shadow: 0 8px 30px rgba(3,6,23,0.6);
      --card-radius: 12px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,Arial;background:linear-gradient(160deg,#0b0c10,#12121a);color:#fff;padding:28px}
    .container{max-width:1100px;margin:0 auto}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
    .brand{font-family:'Playfair Display';font-size:20px;color:var(--accent)}
    main{display:grid;grid-template-columns:1fr 380px;gap:20px}
    .glass{background:var(--glass-bg);border:1px solid var(--glass-border);padding:16px;border-radius:12px;box-shadow:var(--glass-shadow)}
    .form input, .form textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;margin-top:6px}
    .label{font-size:13px;color:var(--muted);margin-top:10px}
    .pay-row{display:flex;gap:10px;align-items:center;margin-top:8px}
    .radio-label{display:flex;align-items:center;gap:8px;cursor:pointer;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);}
    .radio-label input{transform:scale(1.05)}
    .summary img{width:100%;border-radius:8px;margin-bottom:12px}
    .total{font-weight:800;color:var(--accent);margin-top:12px;font-size:18px}
    .btn-pay{display:block;width:100%;padding:12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#021124;font-weight:800;margin-top:12px;cursor:pointer}
    @media(max-width:980px){main{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="container">
    <header><div class="brand">HZ Perfume and Attar</div><nav><a href="index.html" style="color:rgba(255,255,255,0.85);text-decoration:none">Home</a></nav></header>

    <main>
      <section>
        <div class="glass form">
          <h3>Shipping details</h3>

          <div class="label">Full name</div>
          <input id="name" placeholder="Full name">

          <div class="label">Phone number</div>
          <input id="phone" placeholder="03XXXXXXXXX">

          <div class="label">Address</div>
          <textarea id="address" rows="3" placeholder="House, street, city, postal code"></textarea>

          <div class="label">Landmark (optional)</div>
          <input id="landmark" placeholder="Nearby landmark (optional)">

          <div class="label">CNIC (optional)</div>
          <input id="cnic" placeholder="12345-1234567-1">

          <h3 class="label" style="margin-top:14px">Payment method</h3>

          <div class="pay-row">
            <label class="radio-label"><input type="radio" name="payMethod" value="easypaisa"> EasyPaisa</label>
            <label class="radio-label"><input type="radio" name="payMethod" value="jazzcash"> JazzCash</label>
            <label class="radio-label"><input type="radio" name="payMethod" value="cod"> Cash on Delivery</label>
            <label class="radio-label"><input type="radio" name="payMethod" value="bank"> Bank Transfer</label>
          </div>

          <div id="paymentDetails" style="margin-top:12px;display:none" class="glass"></div>

          <button id="placeOrder" class="btn-pay">Place Order</button>
        </div>
      </section>

      <aside>
        <div class="glass summary" id="summaryCard">
          <!-- injected -->
        </div>
      </aside>
    </main>
  </div>

<script>
  function qs(k){ return new URLSearchParams(location.search).get(k) }
  const pid = qs('id') || null;
  const qty = Math.max(1, parseInt(qs('qty') || '1'));
  const DELIVERY = 350;

  // load products set by index
  const stored = localStorage.getItem('hz_products');
  const products = stored ? JSON.parse(stored) : [];
  const p = products.find(x=>x.id===pid) || products[0] || {id:'p1', name:'Product', price:0, img:'https://picsum.photos/seed/default/800/600'};

  // build summary
  const subtotal = (p.price * qty);
  const total = subtotal + DELIVERY;
  const summary = document.getElementById('summaryCard');
  summary.innerHTML = `
    <img src="${p.img}" alt="${p.name}">
    <div style="font-weight:800">${p.name}</div>
    <div style="color:var(--muted);margin-top:8px">${qty} × PKR ${p.price.toLocaleString()}</div>
    <div style="color:var(--muted);margin-top:6px">Delivery: PKR ${DELIVERY}</div>
    <div class="total">Total: PKR ${total.toLocaleString()}</div>
  `;

  // payment details box behaviour
  const payInputs = Array.from(document.querySelectorAll('input[name="payMethod"]'));
  const detailsEl = document.getElementById('paymentDetails');

  function hidePaymentDetails(){ detailsEl.style.display = 'none'; detailsEl.innerHTML = ''; }

  function showEasyPaisa(){
    detailsEl.style.display = 'block';
    detailsEl.innerHTML = `
      <div style="font-weight:700;margin-bottom:8px">EasyPaisa</div>
      <div style="color:var(--muted);margin-bottom:8px">Send payment to: <strong>0344-2898373</strong></div>
      <input id="ep_sender" placeholder="Your EasyPaisa number (03XXXXXXXXX)" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);margin-bottom:8px;background:transparent;color:#fff">
      <input id="ep_txn" placeholder="Transaction / Reference ID" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff">
      <div style="color:var(--muted);font-size:13px;margin-top:8px">Keep TXN ID / screenshot for verification.</div>
    `;
  }
  function showJazzCash(){
    detailsEl.style.display = 'block';
    detailsEl.innerHTML = `
      <div style="font-weight:700;margin-bottom:8px">JazzCash</div>
      <div style="color:var(--muted);margin-bottom:8px">Send payment to: <strong>coming soon</strong></div>
      <input id="jc_sender" placeholder="Your JazzCash number (03XXXXXXXXX)" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);margin-bottom:8px;background:transparent;color:#fff">
      <input id="jc_txn" placeholder="Transaction / Reference ID" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff">
    `;
  }
  function showCOD(){
    detailsEl.style.display = 'block';
    detailsEl.innerHTML = `<div style="font-weight:700">Cash on Delivery</div><div style="color:var(--muted);margin-top:8px">Pay in cash when the delivery arrives.</div>`;
  }
  function showBank(){
    detailsEl.style.display = 'block';
    detailsEl.innerHTML = `
      <div style="font-weight:700;margin-bottom:8px">Bank Transfer</div>
      <div style="color:var(--muted);margin-bottom:8px">Account:coming soon </div>
      <input id="bank_txn" placeholder="Bank transaction/reference ID" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff">
    `;
  }

  payInputs.forEach(r => r.addEventListener('change', e=>{
    const v = e.target.value;
    hidePaymentDetails();
    if(v === 'easypaisa') showEasyPaisa();
    else if(v === 'jazzcash') showJazzCash();
    else if(v === 'cod') showCOD();
    else if(v === 'bank') showBank();
  }));

  // place order handler
  document.getElementById('placeOrder').addEventListener('click', ()=>{
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const address = document.getElementById('address').value.trim();
    const landmark = document.getElementById('landmark').value.trim();
    const cnic = document.getElementById('cnic').value.trim();
    const paySel = document.querySelector('input[name="payMethod"]:checked');

    if(!name || !phone || !address || !paySel){
      alert('Please fill name, phone, address and select a payment method.');
      return;
    }

    const paymentMethod = paySel.value;
    let paymentDetails = {};

    if(paymentMethod === 'easypaisa'){
      const sender = (document.getElementById('ep_sender') || {}).value || '';
      const txn = (document.getElementById('ep_txn') || {}).value || '';
      if(!sender || !txn){ alert('Please provide your EasyPaisa number and transaction ID.'); return; }
      paymentDetails = { sender, txn };
    } else if(paymentMethod === 'jazzcash'){
      const sender = (document.getElementById('jc_sender') || {}).value || '';
      const txn = (document.getElementById('jc_txn') || {}).value || '';
      if(!sender || !txn){ alert('Please provide your JazzCash number and transaction ID.'); return; }
      paymentDetails = { sender, txn };
    } else if(paymentMethod === 'bank'){
      const txn = (document.getElementById('bank_txn') || {}).value || '';
      if(!txn){ alert('Please provide bank transaction/reference ID.'); return; }
      paymentDetails = { txn };
    }

    const order = {
      id: 'ORD' + Date.now(),
      product: { id: p.id, name: p.name, qty, price: p.price },
      subtotal,
      delivery: DELIVERY,
      total,
      shipping: { name, phone, address, landmark, cnic },
      payment: { method: paymentMethod, details: paymentDetails },
      created: new Date().toISOString()
    };

    // save locally
    const ORD_KEY = 'hz_orders_v1';
    const existing = JSON.parse(localStorage.getItem(ORD_KEY) || '[]');
    existing.push(order);
    localStorage.setItem(ORD_KEY, JSON.stringify(existing));

    // OPTIONAL: if you have a Google Apps Script WebApp URL, paste it here to send the order
    const WEBAPP = ''; // <-- paste Apps Script Web App URL if you made one
    if(WEBAPP){
      try {
        fetch(WEBAPP, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(order) })
          .catch(()=>{/* ignore network errors for now */});
      } catch(e){}
    }

    // redirect to thank you
    location.href = 'thankyou.html';
  });
</script>
</body>
</html>
